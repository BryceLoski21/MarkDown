<!-- 那努努力吧 哈哈哈哈哈哈哈哈哈哈哈哈哈哈 -->
# MySQL事务

[TOC]

## 事务的基本概念

事务是由一系列SQL语句组成的一个数据库操作序列,而这些操作是一个不可分割的逻辑工作单元.
如果事务成功执行,那么该事务中的所有更新操作都会执行成功,并将执行结果提交到数据库文件中,成为数据库永久的组成部分.
如果事务中的某条更新操作执行失败,那么事务中的所有操作均被撤销.

为了保证数据能够正确地修改,避免数据的不完整性,事务必须遵循4个原则,即所谓的ACID(原子性,一致性,隔离性和持久性)

- 原子性(Atomicity)
  事务必须是原子工作单元: 事务中的更新操作要么都执行,要么不执行,称为事务的原子性.
  通常,与某个事务关联的操作具有共同的目标,并且是相互依赖的.如果系统只执行执行操作的一个子集,则可以破坏事务的总体目标.
  原子性消除了系统处理操作子集的可能性,用于标识事务是否安全地完成.
- 一致性(Consistency)
  事务的一致性保证了事务完成后,数据库能够处于一致性状态.
  在相关数据库中,所有的规则都必须应用于事务的修改,以保证所有数据的完整性.
  事务结束时,所有的内部数据结构(如B树索引或双向链表)都必须是正确的.
- 隔离性(Isolation)
  同一时刻执行多个事务,称为并发事务.这些事务在执行过程中互不干扰,即一个事务的执行不能被其它事务干扰.
  事务查看数据时数据所处的状态,要么是另一并发事务修改它之前的状态,要么是事务修改它之后的状态,事务不会查看中间状态的数据,这称为可串行性.
  当事务可序列化时将获得最高级别的隔离级别.由于高度隔离会限制可并行执行的事务数,所以一些应用程序降低隔离级别以换取更大的吞吐量.
- 持久性(Durability)
  持久性意味着事务一旦成功执行,在系统中产生的所有变化将是永久的.

## 事务类型

- 系统事务
  系统提供的事务是指在执行某些T-SQL语句时,一条语句就构成了一个事务.
  这些语句是:
  alter table, create, delete, drop, insert, select, update, truncate, rename, replace, begin等.
  这些语句本身就构成了一个事务,要么成功执行,要么对数据库没有任何影响.

- 用户定义的事务
  用户定义的事务是通过事务语句完成的,`MySQL用start transaction语句指定一个事务的开始,用commit语句提交事务,用rollback语句撤销或回滚事务`

## 事务处理


